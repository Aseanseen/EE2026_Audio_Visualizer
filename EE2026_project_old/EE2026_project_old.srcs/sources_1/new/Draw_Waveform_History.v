`timescale 1ns / 1ps
/**
 * Draw Waveform Hist(Mode Selectable)
 * Options:
 * 1 - Standard wave w. ramp
 * 2 - Standard wave (Filled) w. ramp
 * 3 - Block wave (Filled)
 */

module Draw_Waveform_History(
    input clk_sample, //20kHz clock
    input SW0, SW15,
    input LOCK,
    input [5:0] mode,
    input [2:0] wavemode,
    input [2:0] waveformstate,
    input [2:0] histstate,
    input [2:0] circlestate,
    
    input [9:0] wave_sample,
    input [9:0] freq_sample,
    input [11:0] VGA_HORZ_COORD,
    input [11:0] VGA_VERT_COORD,
    input [11:0] colour,
    
    output [3:0] VGA_Red_waveform,
    output [3:0] VGA_Green_waveform,
    output [3:0] VGA_Blue_waveform
    );
    
    //The memory represents the memory array used to store the voice samples.
    //There are 1280 points and each point can range from 0 to 1023. 
    reg [9:0] memory[1279:0];
    
    reg [9:0] counter = 0;
    reg [9:0] prev;
    reg [9:0] maxWave;
    
    //Each wave_sample is displayed on the screen from left to right. 
    always @ (posedge clk_sample) begin
		counter <= (counter >= 49 ? 0 : counter + 1);
		
		prev <= histstate == 1 ? 
		(wave_sample > prev ? wave_sample : prev) :
        (freq_sample > prev ? freq_sample : prev);
		
		if (SW15 == 0 && LOCK == 0 && counter == 0) begin
			memory[1278] <= memory[1279];
			memory[1277] <= memory[1278];
			memory[1276] <= memory[1277];
			memory[1275] <= memory[1276];
			memory[1274] <= memory[1275];
			memory[1273] <= memory[1274];
			memory[1272] <= memory[1273];
			memory[1271] <= memory[1272];
			memory[1270] <= memory[1271];
			memory[1269] <= memory[1270];
			memory[1268] <= memory[1269];
			memory[1267] <= memory[1268];
			memory[1266] <= memory[1267];
			memory[1265] <= memory[1266];
			memory[1264] <= memory[1265];
			memory[1263] <= memory[1264];
			memory[1262] <= memory[1263];
			memory[1261] <= memory[1262];
			memory[1260] <= memory[1261];
			memory[1259] <= memory[1260];
			memory[1258] <= memory[1259];
			memory[1257] <= memory[1258];
			memory[1256] <= memory[1257];
			memory[1255] <= memory[1256];
			memory[1254] <= memory[1255];
			memory[1253] <= memory[1254];
			memory[1252] <= memory[1253];
			memory[1251] <= memory[1252];
			memory[1250] <= memory[1251];
			memory[1249] <= memory[1250];
			memory[1248] <= memory[1249];
			memory[1247] <= memory[1248];
			memory[1246] <= memory[1247];
			memory[1245] <= memory[1246];
			memory[1244] <= memory[1245];
			memory[1243] <= memory[1244];
			memory[1242] <= memory[1243];
			memory[1241] <= memory[1242];
			memory[1240] <= memory[1241];
			memory[1239] <= memory[1240];
			memory[1238] <= memory[1239];
			memory[1237] <= memory[1238];
			memory[1236] <= memory[1237];
			memory[1235] <= memory[1236];
			memory[1234] <= memory[1235];
			memory[1233] <= memory[1234];
			memory[1232] <= memory[1233];
			memory[1231] <= memory[1232];
			memory[1230] <= memory[1231];
			memory[1229] <= memory[1230];
			memory[1228] <= memory[1229];
			memory[1227] <= memory[1228];
			memory[1226] <= memory[1227];
			memory[1225] <= memory[1226];
			memory[1224] <= memory[1225];
			memory[1223] <= memory[1224];
			memory[1222] <= memory[1223];
			memory[1221] <= memory[1222];
			memory[1220] <= memory[1221];
			memory[1219] <= memory[1220];
			memory[1218] <= memory[1219];
			memory[1217] <= memory[1218];
			memory[1216] <= memory[1217];
			memory[1215] <= memory[1216];
			memory[1214] <= memory[1215];
			memory[1213] <= memory[1214];
			memory[1212] <= memory[1213];
			memory[1211] <= memory[1212];
			memory[1210] <= memory[1211];
			memory[1209] <= memory[1210];
			memory[1208] <= memory[1209];
			memory[1207] <= memory[1208];
			memory[1206] <= memory[1207];
			memory[1205] <= memory[1206];
			memory[1204] <= memory[1205];
			memory[1203] <= memory[1204];
			memory[1202] <= memory[1203];
			memory[1201] <= memory[1202];
			memory[1200] <= memory[1201];
			memory[1199] <= memory[1200];
			memory[1198] <= memory[1199];
			memory[1197] <= memory[1198];
			memory[1196] <= memory[1197];
			memory[1195] <= memory[1196];
			memory[1194] <= memory[1195];
			memory[1193] <= memory[1194];
			memory[1192] <= memory[1193];
			memory[1191] <= memory[1192];
			memory[1190] <= memory[1191];
			memory[1189] <= memory[1190];
			memory[1188] <= memory[1189];
			memory[1187] <= memory[1188];
			memory[1186] <= memory[1187];
			memory[1185] <= memory[1186];
			memory[1184] <= memory[1185];
			memory[1183] <= memory[1184];
			memory[1182] <= memory[1183];
			memory[1181] <= memory[1182];
			memory[1180] <= memory[1181];
			memory[1179] <= memory[1180];
			memory[1178] <= memory[1179];
			memory[1177] <= memory[1178];
			memory[1176] <= memory[1177];
			memory[1175] <= memory[1176];
			memory[1174] <= memory[1175];
			memory[1173] <= memory[1174];
			memory[1172] <= memory[1173];
			memory[1171] <= memory[1172];
			memory[1170] <= memory[1171];
			memory[1169] <= memory[1170];
			memory[1168] <= memory[1169];
			memory[1167] <= memory[1168];
			memory[1166] <= memory[1167];
			memory[1165] <= memory[1166];
			memory[1164] <= memory[1165];
			memory[1163] <= memory[1164];
			memory[1162] <= memory[1163];
			memory[1161] <= memory[1162];
			memory[1160] <= memory[1161];
			memory[1159] <= memory[1160];
			memory[1158] <= memory[1159];
			memory[1157] <= memory[1158];
			memory[1156] <= memory[1157];
			memory[1155] <= memory[1156];
			memory[1154] <= memory[1155];
			memory[1153] <= memory[1154];
			memory[1152] <= memory[1153];
			memory[1151] <= memory[1152];
			memory[1150] <= memory[1151];
			memory[1149] <= memory[1150];
			memory[1148] <= memory[1149];
			memory[1147] <= memory[1148];
			memory[1146] <= memory[1147];
			memory[1145] <= memory[1146];
			memory[1144] <= memory[1145];
			memory[1143] <= memory[1144];
			memory[1142] <= memory[1143];
			memory[1141] <= memory[1142];
			memory[1140] <= memory[1141];
			memory[1139] <= memory[1140];
			memory[1138] <= memory[1139];
			memory[1137] <= memory[1138];
			memory[1136] <= memory[1137];
			memory[1135] <= memory[1136];
			memory[1134] <= memory[1135];
			memory[1133] <= memory[1134];
			memory[1132] <= memory[1133];
			memory[1131] <= memory[1132];
			memory[1130] <= memory[1131];
			memory[1129] <= memory[1130];
			memory[1128] <= memory[1129];
			memory[1127] <= memory[1128];
			memory[1126] <= memory[1127];
			memory[1125] <= memory[1126];
			memory[1124] <= memory[1125];
			memory[1123] <= memory[1124];
			memory[1122] <= memory[1123];
			memory[1121] <= memory[1122];
			memory[1120] <= memory[1121];
			memory[1119] <= memory[1120];
			memory[1118] <= memory[1119];
			memory[1117] <= memory[1118];
			memory[1116] <= memory[1117];
			memory[1115] <= memory[1116];
			memory[1114] <= memory[1115];
			memory[1113] <= memory[1114];
			memory[1112] <= memory[1113];
			memory[1111] <= memory[1112];
			memory[1110] <= memory[1111];
			memory[1109] <= memory[1110];
			memory[1108] <= memory[1109];
			memory[1107] <= memory[1108];
			memory[1106] <= memory[1107];
			memory[1105] <= memory[1106];
			memory[1104] <= memory[1105];
			memory[1103] <= memory[1104];
			memory[1102] <= memory[1103];
			memory[1101] <= memory[1102];
			memory[1100] <= memory[1101];
			memory[1099] <= memory[1100];
			memory[1098] <= memory[1099];
			memory[1097] <= memory[1098];
			memory[1096] <= memory[1097];
			memory[1095] <= memory[1096];
			memory[1094] <= memory[1095];
			memory[1093] <= memory[1094];
			memory[1092] <= memory[1093];
			memory[1091] <= memory[1092];
			memory[1090] <= memory[1091];
			memory[1089] <= memory[1090];
			memory[1088] <= memory[1089];
			memory[1087] <= memory[1088];
			memory[1086] <= memory[1087];
			memory[1085] <= memory[1086];
			memory[1084] <= memory[1085];
			memory[1083] <= memory[1084];
			memory[1082] <= memory[1083];
			memory[1081] <= memory[1082];
			memory[1080] <= memory[1081];
			memory[1079] <= memory[1080];
			memory[1078] <= memory[1079];
			memory[1077] <= memory[1078];
			memory[1076] <= memory[1077];
			memory[1075] <= memory[1076];
			memory[1074] <= memory[1075];
			memory[1073] <= memory[1074];
			memory[1072] <= memory[1073];
			memory[1071] <= memory[1072];
			memory[1070] <= memory[1071];
			memory[1069] <= memory[1070];
			memory[1068] <= memory[1069];
			memory[1067] <= memory[1068];
			memory[1066] <= memory[1067];
			memory[1065] <= memory[1066];
			memory[1064] <= memory[1065];
			memory[1063] <= memory[1064];
			memory[1062] <= memory[1063];
			memory[1061] <= memory[1062];
			memory[1060] <= memory[1061];
			memory[1059] <= memory[1060];
			memory[1058] <= memory[1059];
			memory[1057] <= memory[1058];
			memory[1056] <= memory[1057];
			memory[1055] <= memory[1056];
			memory[1054] <= memory[1055];
			memory[1053] <= memory[1054];
			memory[1052] <= memory[1053];
			memory[1051] <= memory[1052];
			memory[1050] <= memory[1051];
			memory[1049] <= memory[1050];
			memory[1048] <= memory[1049];
			memory[1047] <= memory[1048];
			memory[1046] <= memory[1047];
			memory[1045] <= memory[1046];
			memory[1044] <= memory[1045];
			memory[1043] <= memory[1044];
			memory[1042] <= memory[1043];
			memory[1041] <= memory[1042];
			memory[1040] <= memory[1041];
			memory[1039] <= memory[1040];
			memory[1038] <= memory[1039];
			memory[1037] <= memory[1038];
			memory[1036] <= memory[1037];
			memory[1035] <= memory[1036];
			memory[1034] <= memory[1035];
			memory[1033] <= memory[1034];
			memory[1032] <= memory[1033];
			memory[1031] <= memory[1032];
			memory[1030] <= memory[1031];
			memory[1029] <= memory[1030];
			memory[1028] <= memory[1029];
			memory[1027] <= memory[1028];
			memory[1026] <= memory[1027];
			memory[1025] <= memory[1026];
			memory[1024] <= memory[1025];
			memory[1023] <= memory[1024];
			memory[1022] <= memory[1023];
			memory[1021] <= memory[1022];
			memory[1020] <= memory[1021];
			memory[1019] <= memory[1020];
			memory[1018] <= memory[1019];
			memory[1017] <= memory[1018];
			memory[1016] <= memory[1017];
			memory[1015] <= memory[1016];
			memory[1014] <= memory[1015];
			memory[1013] <= memory[1014];
			memory[1012] <= memory[1013];
			memory[1011] <= memory[1012];
			memory[1010] <= memory[1011];
			memory[1009] <= memory[1010];
			memory[1008] <= memory[1009];
			memory[1007] <= memory[1008];
			memory[1006] <= memory[1007];
			memory[1005] <= memory[1006];
			memory[1004] <= memory[1005];
			memory[1003] <= memory[1004];
			memory[1002] <= memory[1003];
			memory[1001] <= memory[1002];
			memory[1000] <= memory[1001];
			memory[999] <= memory[1000];
			memory[998] <= memory[999];
			memory[997] <= memory[998];
			memory[996] <= memory[997];
			memory[995] <= memory[996];
			memory[994] <= memory[995];
			memory[993] <= memory[994];
			memory[992] <= memory[993];
			memory[991] <= memory[992];
			memory[990] <= memory[991];
			memory[989] <= memory[990];
			memory[988] <= memory[989];
			memory[987] <= memory[988];
			memory[986] <= memory[987];
			memory[985] <= memory[986];
			memory[984] <= memory[985];
			memory[983] <= memory[984];
			memory[982] <= memory[983];
			memory[981] <= memory[982];
			memory[980] <= memory[981];
			memory[979] <= memory[980];
			memory[978] <= memory[979];
			memory[977] <= memory[978];
			memory[976] <= memory[977];
			memory[975] <= memory[976];
			memory[974] <= memory[975];
			memory[973] <= memory[974];
			memory[972] <= memory[973];
			memory[971] <= memory[972];
			memory[970] <= memory[971];
			memory[969] <= memory[970];
			memory[968] <= memory[969];
			memory[967] <= memory[968];
			memory[966] <= memory[967];
			memory[965] <= memory[966];
			memory[964] <= memory[965];
			memory[963] <= memory[964];
			memory[962] <= memory[963];
			memory[961] <= memory[962];
			memory[960] <= memory[961];
			memory[959] <= memory[960];
			memory[958] <= memory[959];
			memory[957] <= memory[958];
			memory[956] <= memory[957];
			memory[955] <= memory[956];
			memory[954] <= memory[955];
			memory[953] <= memory[954];
			memory[952] <= memory[953];
			memory[951] <= memory[952];
			memory[950] <= memory[951];
			memory[949] <= memory[950];
			memory[948] <= memory[949];
			memory[947] <= memory[948];
			memory[946] <= memory[947];
			memory[945] <= memory[946];
			memory[944] <= memory[945];
			memory[943] <= memory[944];
			memory[942] <= memory[943];
			memory[941] <= memory[942];
			memory[940] <= memory[941];
			memory[939] <= memory[940];
			memory[938] <= memory[939];
			memory[937] <= memory[938];
			memory[936] <= memory[937];
			memory[935] <= memory[936];
			memory[934] <= memory[935];
			memory[933] <= memory[934];
			memory[932] <= memory[933];
			memory[931] <= memory[932];
			memory[930] <= memory[931];
			memory[929] <= memory[930];
			memory[928] <= memory[929];
			memory[927] <= memory[928];
			memory[926] <= memory[927];
			memory[925] <= memory[926];
			memory[924] <= memory[925];
			memory[923] <= memory[924];
			memory[922] <= memory[923];
			memory[921] <= memory[922];
			memory[920] <= memory[921];
			memory[919] <= memory[920];
			memory[918] <= memory[919];
			memory[917] <= memory[918];
			memory[916] <= memory[917];
			memory[915] <= memory[916];
			memory[914] <= memory[915];
			memory[913] <= memory[914];
			memory[912] <= memory[913];
			memory[911] <= memory[912];
			memory[910] <= memory[911];
			memory[909] <= memory[910];
			memory[908] <= memory[909];
			memory[907] <= memory[908];
			memory[906] <= memory[907];
			memory[905] <= memory[906];
			memory[904] <= memory[905];
			memory[903] <= memory[904];
			memory[902] <= memory[903];
			memory[901] <= memory[902];
			memory[900] <= memory[901];
			memory[899] <= memory[900];
			memory[898] <= memory[899];
			memory[897] <= memory[898];
			memory[896] <= memory[897];
			memory[895] <= memory[896];
			memory[894] <= memory[895];
			memory[893] <= memory[894];
			memory[892] <= memory[893];
			memory[891] <= memory[892];
			memory[890] <= memory[891];
			memory[889] <= memory[890];
			memory[888] <= memory[889];
			memory[887] <= memory[888];
			memory[886] <= memory[887];
			memory[885] <= memory[886];
			memory[884] <= memory[885];
			memory[883] <= memory[884];
			memory[882] <= memory[883];
			memory[881] <= memory[882];
			memory[880] <= memory[881];
			memory[879] <= memory[880];
			memory[878] <= memory[879];
			memory[877] <= memory[878];
			memory[876] <= memory[877];
			memory[875] <= memory[876];
			memory[874] <= memory[875];
			memory[873] <= memory[874];
			memory[872] <= memory[873];
			memory[871] <= memory[872];
			memory[870] <= memory[871];
			memory[869] <= memory[870];
			memory[868] <= memory[869];
			memory[867] <= memory[868];
			memory[866] <= memory[867];
			memory[865] <= memory[866];
			memory[864] <= memory[865];
			memory[863] <= memory[864];
			memory[862] <= memory[863];
			memory[861] <= memory[862];
			memory[860] <= memory[861];
			memory[859] <= memory[860];
			memory[858] <= memory[859];
			memory[857] <= memory[858];
			memory[856] <= memory[857];
			memory[855] <= memory[856];
			memory[854] <= memory[855];
			memory[853] <= memory[854];
			memory[852] <= memory[853];
			memory[851] <= memory[852];
			memory[850] <= memory[851];
			memory[849] <= memory[850];
			memory[848] <= memory[849];
			memory[847] <= memory[848];
			memory[846] <= memory[847];
			memory[845] <= memory[846];
			memory[844] <= memory[845];
			memory[843] <= memory[844];
			memory[842] <= memory[843];
			memory[841] <= memory[842];
			memory[840] <= memory[841];
			memory[839] <= memory[840];
			memory[838] <= memory[839];
			memory[837] <= memory[838];
			memory[836] <= memory[837];
			memory[835] <= memory[836];
			memory[834] <= memory[835];
			memory[833] <= memory[834];
			memory[832] <= memory[833];
			memory[831] <= memory[832];
			memory[830] <= memory[831];
			memory[829] <= memory[830];
			memory[828] <= memory[829];
			memory[827] <= memory[828];
			memory[826] <= memory[827];
			memory[825] <= memory[826];
			memory[824] <= memory[825];
			memory[823] <= memory[824];
			memory[822] <= memory[823];
			memory[821] <= memory[822];
			memory[820] <= memory[821];
			memory[819] <= memory[820];
			memory[818] <= memory[819];
			memory[817] <= memory[818];
			memory[816] <= memory[817];
			memory[815] <= memory[816];
			memory[814] <= memory[815];
			memory[813] <= memory[814];
			memory[812] <= memory[813];
			memory[811] <= memory[812];
			memory[810] <= memory[811];
			memory[809] <= memory[810];
			memory[808] <= memory[809];
			memory[807] <= memory[808];
			memory[806] <= memory[807];
			memory[805] <= memory[806];
			memory[804] <= memory[805];
			memory[803] <= memory[804];
			memory[802] <= memory[803];
			memory[801] <= memory[802];
			memory[800] <= memory[801];
			memory[799] <= memory[800];
			memory[798] <= memory[799];
			memory[797] <= memory[798];
			memory[796] <= memory[797];
			memory[795] <= memory[796];
			memory[794] <= memory[795];
			memory[793] <= memory[794];
			memory[792] <= memory[793];
			memory[791] <= memory[792];
			memory[790] <= memory[791];
			memory[789] <= memory[790];
			memory[788] <= memory[789];
			memory[787] <= memory[788];
			memory[786] <= memory[787];
			memory[785] <= memory[786];
			memory[784] <= memory[785];
			memory[783] <= memory[784];
			memory[782] <= memory[783];
			memory[781] <= memory[782];
			memory[780] <= memory[781];
			memory[779] <= memory[780];
			memory[778] <= memory[779];
			memory[777] <= memory[778];
			memory[776] <= memory[777];
			memory[775] <= memory[776];
			memory[774] <= memory[775];
			memory[773] <= memory[774];
			memory[772] <= memory[773];
			memory[771] <= memory[772];
			memory[770] <= memory[771];
			memory[769] <= memory[770];
			memory[768] <= memory[769];
			memory[767] <= memory[768];
			memory[766] <= memory[767];
			memory[765] <= memory[766];
			memory[764] <= memory[765];
			memory[763] <= memory[764];
			memory[762] <= memory[763];
			memory[761] <= memory[762];
			memory[760] <= memory[761];
			memory[759] <= memory[760];
			memory[758] <= memory[759];
			memory[757] <= memory[758];
			memory[756] <= memory[757];
			memory[755] <= memory[756];
			memory[754] <= memory[755];
			memory[753] <= memory[754];
			memory[752] <= memory[753];
			memory[751] <= memory[752];
			memory[750] <= memory[751];
			memory[749] <= memory[750];
			memory[748] <= memory[749];
			memory[747] <= memory[748];
			memory[746] <= memory[747];
			memory[745] <= memory[746];
			memory[744] <= memory[745];
			memory[743] <= memory[744];
			memory[742] <= memory[743];
			memory[741] <= memory[742];
			memory[740] <= memory[741];
			memory[739] <= memory[740];
			memory[738] <= memory[739];
			memory[737] <= memory[738];
			memory[736] <= memory[737];
			memory[735] <= memory[736];
			memory[734] <= memory[735];
			memory[733] <= memory[734];
			memory[732] <= memory[733];
			memory[731] <= memory[732];
			memory[730] <= memory[731];
			memory[729] <= memory[730];
			memory[728] <= memory[729];
			memory[727] <= memory[728];
			memory[726] <= memory[727];
			memory[725] <= memory[726];
			memory[724] <= memory[725];
			memory[723] <= memory[724];
			memory[722] <= memory[723];
			memory[721] <= memory[722];
			memory[720] <= memory[721];
			memory[719] <= memory[720];
			memory[718] <= memory[719];
			memory[717] <= memory[718];
			memory[716] <= memory[717];
			memory[715] <= memory[716];
			memory[714] <= memory[715];
			memory[713] <= memory[714];
			memory[712] <= memory[713];
			memory[711] <= memory[712];
			memory[710] <= memory[711];
			memory[709] <= memory[710];
			memory[708] <= memory[709];
			memory[707] <= memory[708];
			memory[706] <= memory[707];
			memory[705] <= memory[706];
			memory[704] <= memory[705];
			memory[703] <= memory[704];
			memory[702] <= memory[703];
			memory[701] <= memory[702];
			memory[700] <= memory[701];
			memory[699] <= memory[700];
			memory[698] <= memory[699];
			memory[697] <= memory[698];
			memory[696] <= memory[697];
			memory[695] <= memory[696];
			memory[694] <= memory[695];
			memory[693] <= memory[694];
			memory[692] <= memory[693];
			memory[691] <= memory[692];
			memory[690] <= memory[691];
			memory[689] <= memory[690];
			memory[688] <= memory[689];
			memory[687] <= memory[688];
			memory[686] <= memory[687];
			memory[685] <= memory[686];
			memory[684] <= memory[685];
			memory[683] <= memory[684];
			memory[682] <= memory[683];
			memory[681] <= memory[682];
			memory[680] <= memory[681];
			memory[679] <= memory[680];
			memory[678] <= memory[679];
			memory[677] <= memory[678];
			memory[676] <= memory[677];
			memory[675] <= memory[676];
			memory[674] <= memory[675];
			memory[673] <= memory[674];
			memory[672] <= memory[673];
			memory[671] <= memory[672];
			memory[670] <= memory[671];
			memory[669] <= memory[670];
			memory[668] <= memory[669];
			memory[667] <= memory[668];
			memory[666] <= memory[667];
			memory[665] <= memory[666];
			memory[664] <= memory[665];
			memory[663] <= memory[664];
			memory[662] <= memory[663];
			memory[661] <= memory[662];
			memory[660] <= memory[661];
			memory[659] <= memory[660];
			memory[658] <= memory[659];
			memory[657] <= memory[658];
			memory[656] <= memory[657];
			memory[655] <= memory[656];
			memory[654] <= memory[655];
			memory[653] <= memory[654];
			memory[652] <= memory[653];
			memory[651] <= memory[652];
			memory[650] <= memory[651];
			memory[649] <= memory[650];
			memory[648] <= memory[649];
			memory[647] <= memory[648];
			memory[646] <= memory[647];
			memory[645] <= memory[646];
			memory[644] <= memory[645];
			memory[643] <= memory[644];
			memory[642] <= memory[643];
			memory[641] <= memory[642];
			memory[640] <= memory[641];
			memory[639] <= memory[640];
			memory[638] <= memory[639];
			memory[637] <= memory[638];
			memory[636] <= memory[637];
			memory[635] <= memory[636];
			memory[634] <= memory[635];
			memory[633] <= memory[634];
			memory[632] <= memory[633];
			memory[631] <= memory[632];
			memory[630] <= memory[631];
			memory[629] <= memory[630];
			memory[628] <= memory[629];
			memory[627] <= memory[628];
			memory[626] <= memory[627];
			memory[625] <= memory[626];
			memory[624] <= memory[625];
			memory[623] <= memory[624];
			memory[622] <= memory[623];
			memory[621] <= memory[622];
			memory[620] <= memory[621];
			memory[619] <= memory[620];
			memory[618] <= memory[619];
			memory[617] <= memory[618];
			memory[616] <= memory[617];
			memory[615] <= memory[616];
			memory[614] <= memory[615];
			memory[613] <= memory[614];
			memory[612] <= memory[613];
			memory[611] <= memory[612];
			memory[610] <= memory[611];
			memory[609] <= memory[610];
			memory[608] <= memory[609];
			memory[607] <= memory[608];
			memory[606] <= memory[607];
			memory[605] <= memory[606];
			memory[604] <= memory[605];
			memory[603] <= memory[604];
			memory[602] <= memory[603];
			memory[601] <= memory[602];
			memory[600] <= memory[601];
			memory[599] <= memory[600];
			memory[598] <= memory[599];
			memory[597] <= memory[598];
			memory[596] <= memory[597];
			memory[595] <= memory[596];
			memory[594] <= memory[595];
			memory[593] <= memory[594];
			memory[592] <= memory[593];
			memory[591] <= memory[592];
			memory[590] <= memory[591];
			memory[589] <= memory[590];
			memory[588] <= memory[589];
			memory[587] <= memory[588];
			memory[586] <= memory[587];
			memory[585] <= memory[586];
			memory[584] <= memory[585];
			memory[583] <= memory[584];
			memory[582] <= memory[583];
			memory[581] <= memory[582];
			memory[580] <= memory[581];
			memory[579] <= memory[580];
			memory[578] <= memory[579];
			memory[577] <= memory[578];
			memory[576] <= memory[577];
			memory[575] <= memory[576];
			memory[574] <= memory[575];
			memory[573] <= memory[574];
			memory[572] <= memory[573];
			memory[571] <= memory[572];
			memory[570] <= memory[571];
			memory[569] <= memory[570];
			memory[568] <= memory[569];
			memory[567] <= memory[568];
			memory[566] <= memory[567];
			memory[565] <= memory[566];
			memory[564] <= memory[565];
			memory[563] <= memory[564];
			memory[562] <= memory[563];
			memory[561] <= memory[562];
			memory[560] <= memory[561];
			memory[559] <= memory[560];
			memory[558] <= memory[559];
			memory[557] <= memory[558];
			memory[556] <= memory[557];
			memory[555] <= memory[556];
			memory[554] <= memory[555];
			memory[553] <= memory[554];
			memory[552] <= memory[553];
			memory[551] <= memory[552];
			memory[550] <= memory[551];
			memory[549] <= memory[550];
			memory[548] <= memory[549];
			memory[547] <= memory[548];
			memory[546] <= memory[547];
			memory[545] <= memory[546];
			memory[544] <= memory[545];
			memory[543] <= memory[544];
			memory[542] <= memory[543];
			memory[541] <= memory[542];
			memory[540] <= memory[541];
			memory[539] <= memory[540];
			memory[538] <= memory[539];
			memory[537] <= memory[538];
			memory[536] <= memory[537];
			memory[535] <= memory[536];
			memory[534] <= memory[535];
			memory[533] <= memory[534];
			memory[532] <= memory[533];
			memory[531] <= memory[532];
			memory[530] <= memory[531];
			memory[529] <= memory[530];
			memory[528] <= memory[529];
			memory[527] <= memory[528];
			memory[526] <= memory[527];
			memory[525] <= memory[526];
			memory[524] <= memory[525];
			memory[523] <= memory[524];
			memory[522] <= memory[523];
			memory[521] <= memory[522];
			memory[520] <= memory[521];
			memory[519] <= memory[520];
			memory[518] <= memory[519];
			memory[517] <= memory[518];
			memory[516] <= memory[517];
			memory[515] <= memory[516];
			memory[514] <= memory[515];
			memory[513] <= memory[514];
			memory[512] <= memory[513];
			memory[511] <= memory[512];
			memory[510] <= memory[511];
			memory[509] <= memory[510];
			memory[508] <= memory[509];
			memory[507] <= memory[508];
			memory[506] <= memory[507];
			memory[505] <= memory[506];
			memory[504] <= memory[505];
			memory[503] <= memory[504];
			memory[502] <= memory[503];
			memory[501] <= memory[502];
			memory[500] <= memory[501];
			memory[499] <= memory[500];
			memory[498] <= memory[499];
			memory[497] <= memory[498];
			memory[496] <= memory[497];
			memory[495] <= memory[496];
			memory[494] <= memory[495];
			memory[493] <= memory[494];
			memory[492] <= memory[493];
			memory[491] <= memory[492];
			memory[490] <= memory[491];
			memory[489] <= memory[490];
			memory[488] <= memory[489];
			memory[487] <= memory[488];
			memory[486] <= memory[487];
			memory[485] <= memory[486];
			memory[484] <= memory[485];
			memory[483] <= memory[484];
			memory[482] <= memory[483];
			memory[481] <= memory[482];
			memory[480] <= memory[481];
			memory[479] <= memory[480];
			memory[478] <= memory[479];
			memory[477] <= memory[478];
			memory[476] <= memory[477];
			memory[475] <= memory[476];
			memory[474] <= memory[475];
			memory[473] <= memory[474];
			memory[472] <= memory[473];
			memory[471] <= memory[472];
			memory[470] <= memory[471];
			memory[469] <= memory[470];
			memory[468] <= memory[469];
			memory[467] <= memory[468];
			memory[466] <= memory[467];
			memory[465] <= memory[466];
			memory[464] <= memory[465];
			memory[463] <= memory[464];
			memory[462] <= memory[463];
			memory[461] <= memory[462];
			memory[460] <= memory[461];
			memory[459] <= memory[460];
			memory[458] <= memory[459];
			memory[457] <= memory[458];
			memory[456] <= memory[457];
			memory[455] <= memory[456];
			memory[454] <= memory[455];
			memory[453] <= memory[454];
			memory[452] <= memory[453];
			memory[451] <= memory[452];
			memory[450] <= memory[451];
			memory[449] <= memory[450];
			memory[448] <= memory[449];
			memory[447] <= memory[448];
			memory[446] <= memory[447];
			memory[445] <= memory[446];
			memory[444] <= memory[445];
			memory[443] <= memory[444];
			memory[442] <= memory[443];
			memory[441] <= memory[442];
			memory[440] <= memory[441];
			memory[439] <= memory[440];
			memory[438] <= memory[439];
			memory[437] <= memory[438];
			memory[436] <= memory[437];
			memory[435] <= memory[436];
			memory[434] <= memory[435];
			memory[433] <= memory[434];
			memory[432] <= memory[433];
			memory[431] <= memory[432];
			memory[430] <= memory[431];
			memory[429] <= memory[430];
			memory[428] <= memory[429];
			memory[427] <= memory[428];
			memory[426] <= memory[427];
			memory[425] <= memory[426];
			memory[424] <= memory[425];
			memory[423] <= memory[424];
			memory[422] <= memory[423];
			memory[421] <= memory[422];
			memory[420] <= memory[421];
			memory[419] <= memory[420];
			memory[418] <= memory[419];
			memory[417] <= memory[418];
			memory[416] <= memory[417];
			memory[415] <= memory[416];
			memory[414] <= memory[415];
			memory[413] <= memory[414];
			memory[412] <= memory[413];
			memory[411] <= memory[412];
			memory[410] <= memory[411];
			memory[409] <= memory[410];
			memory[408] <= memory[409];
			memory[407] <= memory[408];
			memory[406] <= memory[407];
			memory[405] <= memory[406];
			memory[404] <= memory[405];
			memory[403] <= memory[404];
			memory[402] <= memory[403];
			memory[401] <= memory[402];
			memory[400] <= memory[401];
			memory[399] <= memory[400];
			memory[398] <= memory[399];
			memory[397] <= memory[398];
			memory[396] <= memory[397];
			memory[395] <= memory[396];
			memory[394] <= memory[395];
			memory[393] <= memory[394];
			memory[392] <= memory[393];
			memory[391] <= memory[392];
			memory[390] <= memory[391];
			memory[389] <= memory[390];
			memory[388] <= memory[389];
			memory[387] <= memory[388];
			memory[386] <= memory[387];
			memory[385] <= memory[386];
			memory[384] <= memory[385];
			memory[383] <= memory[384];
			memory[382] <= memory[383];
			memory[381] <= memory[382];
			memory[380] <= memory[381];
			memory[379] <= memory[380];
			memory[378] <= memory[379];
			memory[377] <= memory[378];
			memory[376] <= memory[377];
			memory[375] <= memory[376];
			memory[374] <= memory[375];
			memory[373] <= memory[374];
			memory[372] <= memory[373];
			memory[371] <= memory[372];
			memory[370] <= memory[371];
			memory[369] <= memory[370];
			memory[368] <= memory[369];
			memory[367] <= memory[368];
			memory[366] <= memory[367];
			memory[365] <= memory[366];
			memory[364] <= memory[365];
			memory[363] <= memory[364];
			memory[362] <= memory[363];
			memory[361] <= memory[362];
			memory[360] <= memory[361];
			memory[359] <= memory[360];
			memory[358] <= memory[359];
			memory[357] <= memory[358];
			memory[356] <= memory[357];
			memory[355] <= memory[356];
			memory[354] <= memory[355];
			memory[353] <= memory[354];
			memory[352] <= memory[353];
			memory[351] <= memory[352];
			memory[350] <= memory[351];
			memory[349] <= memory[350];
			memory[348] <= memory[349];
			memory[347] <= memory[348];
			memory[346] <= memory[347];
			memory[345] <= memory[346];
			memory[344] <= memory[345];
			memory[343] <= memory[344];
			memory[342] <= memory[343];
			memory[341] <= memory[342];
			memory[340] <= memory[341];
			memory[339] <= memory[340];
			memory[338] <= memory[339];
			memory[337] <= memory[338];
			memory[336] <= memory[337];
			memory[335] <= memory[336];
			memory[334] <= memory[335];
			memory[333] <= memory[334];
			memory[332] <= memory[333];
			memory[331] <= memory[332];
			memory[330] <= memory[331];
			memory[329] <= memory[330];
			memory[328] <= memory[329];
			memory[327] <= memory[328];
			memory[326] <= memory[327];
			memory[325] <= memory[326];
			memory[324] <= memory[325];
			memory[323] <= memory[324];
			memory[322] <= memory[323];
			memory[321] <= memory[322];
			memory[320] <= memory[321];
			memory[319] <= memory[320];
			memory[318] <= memory[319];
			memory[317] <= memory[318];
			memory[316] <= memory[317];
			memory[315] <= memory[316];
			memory[314] <= memory[315];
			memory[313] <= memory[314];
			memory[312] <= memory[313];
			memory[311] <= memory[312];
			memory[310] <= memory[311];
			memory[309] <= memory[310];
			memory[308] <= memory[309];
			memory[307] <= memory[308];
			memory[306] <= memory[307];
			memory[305] <= memory[306];
			memory[304] <= memory[305];
			memory[303] <= memory[304];
			memory[302] <= memory[303];
			memory[301] <= memory[302];
			memory[300] <= memory[301];
			memory[299] <= memory[300];
			memory[298] <= memory[299];
			memory[297] <= memory[298];
			memory[296] <= memory[297];
			memory[295] <= memory[296];
			memory[294] <= memory[295];
			memory[293] <= memory[294];
			memory[292] <= memory[293];
			memory[291] <= memory[292];
			memory[290] <= memory[291];
			memory[289] <= memory[290];
			memory[288] <= memory[289];
			memory[287] <= memory[288];
			memory[286] <= memory[287];
			memory[285] <= memory[286];
			memory[284] <= memory[285];
			memory[283] <= memory[284];
			memory[282] <= memory[283];
			memory[281] <= memory[282];
			memory[280] <= memory[281];
			memory[279] <= memory[280];
			memory[278] <= memory[279];
			memory[277] <= memory[278];
			memory[276] <= memory[277];
			memory[275] <= memory[276];
			memory[274] <= memory[275];
			memory[273] <= memory[274];
			memory[272] <= memory[273];
			memory[271] <= memory[272];
			memory[270] <= memory[271];
			memory[269] <= memory[270];
			memory[268] <= memory[269];
			memory[267] <= memory[268];
			memory[266] <= memory[267];
			memory[265] <= memory[266];
			memory[264] <= memory[265];
			memory[263] <= memory[264];
			memory[262] <= memory[263];
			memory[261] <= memory[262];
			memory[260] <= memory[261];
			memory[259] <= memory[260];
			memory[258] <= memory[259];
			memory[257] <= memory[258];
			memory[256] <= memory[257];
			memory[255] <= memory[256];
			memory[254] <= memory[255];
			memory[253] <= memory[254];
			memory[252] <= memory[253];
			memory[251] <= memory[252];
			memory[250] <= memory[251];
			memory[249] <= memory[250];
			memory[248] <= memory[249];
			memory[247] <= memory[248];
			memory[246] <= memory[247];
			memory[245] <= memory[246];
			memory[244] <= memory[245];
			memory[243] <= memory[244];
			memory[242] <= memory[243];
			memory[241] <= memory[242];
			memory[240] <= memory[241];
			memory[239] <= memory[240];
			memory[238] <= memory[239];
			memory[237] <= memory[238];
			memory[236] <= memory[237];
			memory[235] <= memory[236];
			memory[234] <= memory[235];
			memory[233] <= memory[234];
			memory[232] <= memory[233];
			memory[231] <= memory[232];
			memory[230] <= memory[231];
			memory[229] <= memory[230];
			memory[228] <= memory[229];
			memory[227] <= memory[228];
			memory[226] <= memory[227];
			memory[225] <= memory[226];
			memory[224] <= memory[225];
			memory[223] <= memory[224];
			memory[222] <= memory[223];
			memory[221] <= memory[222];
			memory[220] <= memory[221];
			memory[219] <= memory[220];
			memory[218] <= memory[219];
			memory[217] <= memory[218];
			memory[216] <= memory[217];
			memory[215] <= memory[216];
			memory[214] <= memory[215];
			memory[213] <= memory[214];
			memory[212] <= memory[213];
			memory[211] <= memory[212];
			memory[210] <= memory[211];
			memory[209] <= memory[210];
			memory[208] <= memory[209];
			memory[207] <= memory[208];
			memory[206] <= memory[207];
			memory[205] <= memory[206];
			memory[204] <= memory[205];
			memory[203] <= memory[204];
			memory[202] <= memory[203];
			memory[201] <= memory[202];
			memory[200] <= memory[201];
			memory[199] <= memory[200];
			memory[198] <= memory[199];
			memory[197] <= memory[198];
			memory[196] <= memory[197];
			memory[195] <= memory[196];
			memory[194] <= memory[195];
			memory[193] <= memory[194];
			memory[192] <= memory[193];
			memory[191] <= memory[192];
			memory[190] <= memory[191];
			memory[189] <= memory[190];
			memory[188] <= memory[189];
			memory[187] <= memory[188];
			memory[186] <= memory[187];
			memory[185] <= memory[186];
			memory[184] <= memory[185];
			memory[183] <= memory[184];
			memory[182] <= memory[183];
			memory[181] <= memory[182];
			memory[180] <= memory[181];
			memory[179] <= memory[180];
			memory[178] <= memory[179];
			memory[177] <= memory[178];
			memory[176] <= memory[177];
			memory[175] <= memory[176];
			memory[174] <= memory[175];
			memory[173] <= memory[174];
			memory[172] <= memory[173];
			memory[171] <= memory[172];
			memory[170] <= memory[171];
			memory[169] <= memory[170];
			memory[168] <= memory[169];
			memory[167] <= memory[168];
			memory[166] <= memory[167];
			memory[165] <= memory[166];
			memory[164] <= memory[165];
			memory[163] <= memory[164];
			memory[162] <= memory[163];
			memory[161] <= memory[162];
			memory[160] <= memory[161];
			memory[159] <= memory[160];
			memory[158] <= memory[159];
			memory[157] <= memory[158];
			memory[156] <= memory[157];
			memory[155] <= memory[156];
			memory[154] <= memory[155];
			memory[153] <= memory[154];
			memory[152] <= memory[153];
			memory[151] <= memory[152];
			memory[150] <= memory[151];
			memory[149] <= memory[150];
			memory[148] <= memory[149];
			memory[147] <= memory[148];
			memory[146] <= memory[147];
			memory[145] <= memory[146];
			memory[144] <= memory[145];
			memory[143] <= memory[144];
			memory[142] <= memory[143];
			memory[141] <= memory[142];
			memory[140] <= memory[141];
			memory[139] <= memory[140];
			memory[138] <= memory[139];
			memory[137] <= memory[138];
			memory[136] <= memory[137];
			memory[135] <= memory[136];
			memory[134] <= memory[135];
			memory[133] <= memory[134];
			memory[132] <= memory[133];
			memory[131] <= memory[132];
			memory[130] <= memory[131];
			memory[129] <= memory[130];
			memory[128] <= memory[129];
			memory[127] <= memory[128];
			memory[126] <= memory[127];
			memory[125] <= memory[126];
			memory[124] <= memory[125];
			memory[123] <= memory[124];
			memory[122] <= memory[123];
			memory[121] <= memory[122];
			memory[120] <= memory[121];
			memory[119] <= memory[120];
			memory[118] <= memory[119];
			memory[117] <= memory[118];
			memory[116] <= memory[117];
			memory[115] <= memory[116];
			memory[114] <= memory[115];
			memory[113] <= memory[114];
			memory[112] <= memory[113];
			memory[111] <= memory[112];
			memory[110] <= memory[111];
			memory[109] <= memory[110];
			memory[108] <= memory[109];
			memory[107] <= memory[108];
			memory[106] <= memory[107];
			memory[105] <= memory[106];
			memory[104] <= memory[105];
			memory[103] <= memory[104];
			memory[102] <= memory[103];
			memory[101] <= memory[102];
			memory[100] <= memory[101];
			memory[99] <= memory[100];
			memory[98] <= memory[99];
			memory[97] <= memory[98];
			memory[96] <= memory[97];
			memory[95] <= memory[96];
			memory[94] <= memory[95];
			memory[93] <= memory[94];
			memory[92] <= memory[93];
			memory[91] <= memory[92];
			memory[90] <= memory[91];
			memory[89] <= memory[90];
			memory[88] <= memory[89];
			memory[87] <= memory[88];
			memory[86] <= memory[87];
			memory[85] <= memory[86];
			memory[84] <= memory[85];
			memory[83] <= memory[84];
			memory[82] <= memory[83];
			memory[81] <= memory[82];
			memory[80] <= memory[81];
			memory[79] <= memory[80];
			memory[78] <= memory[79];
			memory[77] <= memory[78];
			memory[76] <= memory[77];
			memory[75] <= memory[76];
			memory[74] <= memory[75];
			memory[73] <= memory[74];
			memory[72] <= memory[73];
			memory[71] <= memory[72];
			memory[70] <= memory[71];
			memory[69] <= memory[70];
			memory[68] <= memory[69];
			memory[67] <= memory[68];
			memory[66] <= memory[67];
			memory[65] <= memory[66];
			memory[64] <= memory[65];
			memory[63] <= memory[64];
			memory[62] <= memory[63];
			memory[61] <= memory[62];
			memory[60] <= memory[61];
			memory[59] <= memory[60];
			memory[58] <= memory[59];
			memory[57] <= memory[58];
			memory[56] <= memory[57];
			memory[55] <= memory[56];
			memory[54] <= memory[55];
			memory[53] <= memory[54];
			memory[52] <= memory[53];
			memory[51] <= memory[52];
			memory[50] <= memory[51];
			memory[49] <= memory[50];
			memory[48] <= memory[49];
			memory[47] <= memory[48];
			memory[46] <= memory[47];
			memory[45] <= memory[46];
			memory[44] <= memory[45];
			memory[43] <= memory[44];
			memory[42] <= memory[43];
			memory[41] <= memory[42];
			memory[40] <= memory[41];
			memory[39] <= memory[40];
			memory[38] <= memory[39];
			memory[37] <= memory[38];
			memory[36] <= memory[37];
			memory[35] <= memory[36];
			memory[34] <= memory[35];
			memory[33] <= memory[34];
			memory[32] <= memory[33];
			memory[31] <= memory[32];
			memory[30] <= memory[31];
			memory[29] <= memory[30];
			memory[28] <= memory[29];
			memory[27] <= memory[28];
			memory[26] <= memory[27];
			memory[25] <= memory[26];
			memory[24] <= memory[25];
			memory[23] <= memory[24];
			memory[22] <= memory[23];
			memory[21] <= memory[22];
			memory[20] <= memory[21];
			memory[19] <= memory[20];
			memory[18] <= memory[19];
			memory[17] <= memory[18];
			memory[16] <= memory[17];
			memory[15] <= memory[16];
			memory[14] <= memory[15];
			memory[13] <= memory[14];
			memory[12] <= memory[13];
			memory[11] <= memory[12];
			memory[10] <= memory[11];
			memory[9] <= memory[10];
			memory[8] <= memory[9];
			memory[7] <= memory[8];
			memory[6] <= memory[7];
			memory[5] <= memory[6];
			memory[4] <= memory[5];
			memory[3] <= memory[4];
			memory[2] <= memory[3];
			memory[1] <= memory[2];
			memory[0] <= memory[1];
			
			//volume history
			if (histstate == 1) begin
                memory[1279] <= prev;
                prev <= 0;
			end
			
			//freq history
			if (histstate == 2) begin
                memory[1279] <= prev;
                prev <= 0;
			end
			
			//nyan cat
			if (histstate == 3) begin
                memory[1279] <= prev * 2;
                prev <= 0;
			end
			
			
			//prev <= wave_sample;
		end		
    end
     
    wire [3:0] red;
    wire [3:0] green;
    wire [3:0] blue;
    
    assign red = colour >> 8;
    assign green = colour << 4 >> 8;
    assign blue = colour << 8 >> 8;
    
    //assign 50 to 1
    assign VGA_Red_waveform = (VGA_HORZ_COORD < 1279) && VGA_VERT_COORD == (1024 - memory[VGA_HORZ_COORD - 1]) ? red : 0;
    assign VGA_Green_waveform = (VGA_HORZ_COORD < 1279) && VGA_VERT_COORD == (1024 - memory[VGA_HORZ_COORD - 1]) ? green : 0;
    assign VGA_Blue_waveform = (VGA_HORZ_COORD < 1279) && VGA_VERT_COORD == (1024 - memory[VGA_HORZ_COORD - 1]) ? blue : 0;
    
    /*assign VGA_Red_waveform = (VGA_HORZ_COORD < 1279) && VGA_VERT_COORD == (1024 - memory[VGA_HORZ_COORD - 100]) ? red : 0;
    assign VGA_Green_waveform = (VGA_HORZ_COORD < 1279) && VGA_VERT_COORD == (1024 - memory[VGA_HORZ_COORD - 100]) ? green : 0;
    assign VGA_Blue_waveform = (VGA_HORZ_COORD < 1279) && VGA_VERT_COORD == (1024 - memory[VGA_HORZ_COORD - 100]) ? blue : 0;*/
    
endmodule
